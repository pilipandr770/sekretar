# AI-Секретар — Специфікація MVP

## Цілі проекту

Створити омніканальну SaaS платформу з мультиагентним AI-секретарем для SMB, що включає:
- Уніфікований Inbox з AI-обробкою повідомлень
- CRM з управлінням лідами та задачами  
- Інтеграцію з Google Calendar
- RAG-базу знань з документами
- Інвойсинг через Stripe
- KYB-моніторинг контрагентів (VIES, санкції, неплатоспроможність, LEI)

## Скоп MVP

### Обов'язкові функції

**Омніканальна комунікація:**
- Telegram Bot (webhook)
- Signal через signal-cli
- Web Widget (JS кнопка/iframe)

**Inbox Management:**
- Єдина стрічка звернень з усіх каналів
- AI авто-відповіді через OpenAI Assistants
- Маршрутизація намірів (Router Agent)
- Ручний handoff до агентів

**CRM (власна реалізація):**
- Ліди з пайплайном та етапами
- Задачі з призначенням та термінами
- Нотатки та історія взаємодій
- Зв'язок діалогів з лідами

**Календар:**
- Google Calendar OAuth інтеграція
- Бронювання доступних слотів
- Автоматичні інвайти

**RAG База знань:**
- Завантаження PDF/DOC/MD/URL
- Індексація та векторний пошук
- AI відповіді з цитатами джерел

**Інвойсинг:**
- Виставлення рахунків через Stripe
- Checkout/Payment Link генерація
- Відстеження статусу оплат

**KYB Моніторинг:**
- Додавання контрагентів (VAT/LEI/назва+країна)
- Перевірка через VIES (EU VAT)
- Моніторинг санкцій (EU/OFAC/UK)
- Insolvenzbekanntmachungen (DE)
- GLEIF/LEI валідація
- Щоденний/щотижневий моніторинг
- Алерти при змінах
- Risk score розрахунок
- Evidence snapshots

## Тарифні плани

### Trial
- **Тривалість:** 3 дні повного доступу
- **Обмеження:** Після закінчення - тільки читання історії
- **Конверсія:** Автоматичне пропонування Starter плану

### Starter - 29€/міс
- 1 користувач
- 2 канали комунікації
- 1,000 RAG повідомлень/міс
- KYB: 10 суб'єктів, щотижневий моніторинг

### Pro - 79€/міс  
- 5 користувачів
- 4 канали комунікації
- 5,000 RAG повідомлень/міс
- KYB: 50 суб'єктів, щоденний моніторинг + Insolvenz/LEI

### Team - 149€/міс
- 10 користувачів
- WhatsApp (коли додамо)
- 15,000 RAG повідомлень/міс
- KYB: 200 суб'єктів + BaFin warnings

### Enterprise - 300+€/міс
- Кастомні обмеження
- Додаткові інтеграції
- Пріоритетна підтримка

### Overages
- RAG +1,000 повідомлень = 3€
- KYB +10 суб'єктів = 5€/міс
- Позапланова KYB перевірка = 0.20€

## Мультиагентна архітектура

**Router Agent:**
- Детекція мови, намірів, контексту клієнта
- Маршрутизація до Sales/Support/Billing/Ops агентів

**Supervisor Agent:**
- Фільтрація токсичного контенту
- Детекція та маскування PII
- Дотримання політик компанії

**Спеціалізовані агенти:**
- **Sales Agent:** Кваліфікація лідів, продажі
- **Support Agent:** Технічна підтримка
- **Billing Agent:** Питання підписок та оплат
- **Operations Agent:** Загальні бізнес-операції

**Ask-Me інтерфейс:**
- Доступ до календаря, CRM, KYB даних
- Контекстні відповіді на основі внутрішніх даних

## Нефункціональні вимоги

**Multi-tenant архітектура:**
- Повна ізоляція даних між організаціями
- Ролі: Owner/Manager/Support/Accounting/Read-only

**GDPR/DSGVO відповідність:**
- Мінімізація збору PII
- Retention policies з автоматичним видаленням
- Експорт/видалення даних на запит
- Повний audit log всіх операцій

**Продуктивність:**
- Rate limiting через Redis
- Черги Celery/RQ для фонових задач
- Горизонтальне масштабування

**Безпека:**
- JWT аутентифікація
- Шифрування чутливих даних
- Регулярні security аудити

## Технічний стек

**Backend:** Flask, SQLAlchemy, PostgreSQL, Redis, Celery
**AI:** OpenAI API, векторна база для RAG
**Платежі:** Stripe API
**Інтеграції:** Google Calendar, Telegram Bot API, signal-cli
**Деплой:** Render.com з PostgreSQL схемами для ізоляції

## KYB Джерела (MVP)

1. **VIES** - EU VAT number validation
2. **EU/OFAC/UK Sanctions** - Санкційні списки
3. **Insolvenzbekanntmachungen** - Німецькі повідомлення про неплатоспроможність
4. **GLEIF/LEI** - Legal Entity Identifier validation

**Наступний етап:** Bundesanzeiger, BaFin warnings

## Критерії приймання MVP

### Функціональні тести:
1. ✅ Створення тенанта з owner користувачем
2. ✅ Підключення Telegram Bot та Signal
3. ✅ Отримання повідомлення в Inbox з AI авто-відповіддю
4. ✅ Створення ліда з CRM
5. ✅ Бронювання слоту в Google Calendar
6. ✅ Завантаження PDF в Knowledge з пошуком та цитатами
7. ✅ Виставлення Stripe інвойсу з відстеженням оплати
8. ✅ Додавання контрагента (VAT/LEI) з отриманням алерту при зміні
9. ✅ Робота 3-денного trial з блокуванням після закінчення
10. ✅ Тест Stripe webhooks

### Технічні критерії:
- Час відповіді API < 200ms для 95% запитів
- Доступність 99.9%
- Підтримка 100+ одночасних користувачів
- GDPR compliance audit пройдений
- Security penetration test пройдений

## Потоки користувача

**Онбординг:**
1. Реєстрація → 3-денний trial
2. Підключення каналів (Telegram/Signal/Widget)
3. Завантаження базових знань
4. Тестові звернення
5. Налаштування CRM пайплайну

**Щоденна робота:**
1. Перегляд Inbox з новими зверненнями
2. Обробка лідів в CRM
3. Планування задач та зустрічей
4. Моніторинг KYB алертів
5. Виставлення інвойсів

**Адміністрування:**
1. Управління користувачами та ролями
2. Налаштування AI агентів
3. Конфігурація каналів
4. Аналітика використання
5. Управління підпискою

## Метрики успіху

**Бізнес метрики:**
- Trial → Paid конверсія > 15%
- Monthly churn < 5%
- NPS > 50
- Average revenue per user > 60€

**Продуктові метрики:**
- AI accuracy > 85%
- Response time < 30 секунд
- User engagement > 80% DAU/MAU
- Feature adoption > 70% для core features

**Технічні метрики:**
- API uptime > 99.9%
- Error rate < 0.1%
- P95 response time < 200ms
- Zero security incidents